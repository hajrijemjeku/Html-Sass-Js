<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body style="background-color: rgb(191, 183, 226); color: rgb(140, 231, 235);">

    <div class="container my-5">
        <div id="news_div" style="font-size: 34px; margin: 100px 0px;"></div>
        <input type="search" name="" id="search-inp" placeholder="Search...">
        <button onclick="clickedSrc()" id="generate_news_btn" class="btn btn-primary">Search</button>
        <button id="showMore">Show More</button>
    </div>
    
    
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="node_modules/axios/dist/axios.js"></script>

    <script>
        //const submit_btn = document.querySelector('#submit-btn');

        var limit = 2;
        var api = `http://api.mediastack.com/v1/news?access_key=6f911dfbc60305aead5a412a18b628af&sources=bbc&languages=en&`
        var api_url = `${api}limit=${limit}`;
        //var api_url = '';
        const showMore = document.querySelector('#showMore');
        const generate_news_btn = document.querySelector('#generate_news_btn');
        showMore.style.display = 'none';

        //SEARCH BTN
        generate_news_btn.addEventListener('click', (e) => {
            const searchvalue = document.querySelector('#search-inp').value;
            const url = `${api_url}&keywords=${searchvalue}`;
            
            axios.get(url)
                .then(response => {
                    news_div(response.data);
                })
                .catch(error => console.log(error));

            e.preventDefault();
            showMore.style.display = '';
        });

        showMore.addEventListener('click', (e) =>{
            limit += 2;
            console.log(limit);
            var api_url = `${api}limit=${limit}`;

            const searchvalue = document.querySelector('#search-inp').value;
            const url = `${api_url}&keywords=${searchvalue}`;            
            
            axios.get(url)
                .then(response => {
                    news_div(response.data);
                })
                .catch(error => console.log(error));

            console.log(api_url);
        })


        const news_div = (data) => {
            let result = '';

                data.data.forEach(item =>{
                    const d = `${item.description}`
                    result += `<p>${d}</p>`;
                })

                //result += "</div>";
                //news_div.innerHTML = result;

            const news_div = document.querySelector('#news_div');
            news_div.innerHTML = result;
            //const searchvalue = `${data.data[0].description} </br> ${data.data.url}`;

            //news_div.innerHTML = searchvalue;
        };

        function clickedSrc(){
            generate_news_btn.addEventListener('click', event => {
                limit = 2;
                console.clear();
            });
        }

        
    </script>
</body>
</html>